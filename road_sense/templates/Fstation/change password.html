{% extends 'Fstation/Homeindex.html' %}
{% block body %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
  .password-toggle {
    position: relative;
  }
  .password-toggle .toggle-password {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
  }
</style>


<script>
  function togglePasswordVisibility(inputId, iconId) {
    var input = document.getElementById(inputId);
    var icon = document.getElementById(iconId);

    if (input.type === "password") {
      input.type = "text";
      icon.classList.add("fa-eye");
      icon.classList.remove("fa-eye-slash");
    } else {
      input.type = "password";
      icon.classList.add("fa-eye-slash");
      icon.classList.remove("fa-eye");
    }
  }
  function validateForm() {
    var newPassword = document.getElementById('textfield2').value;
    var confirmPassword = document.getElementById('textfield3').value;

    // Password pattern - at least 8 characters, with at least one uppercase letter, one lowercase letter, one number, and one special character
    var passwordPattern = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()_+}{'\:;?\/>.<,])[A-Za-z\d!@#$%^&*()_+}{'\:;?\/>.<,]{8,}$/;

    if (!passwordPattern.test(newPassword)) {
      alert("Password must contain at least 8 characters, including at least one uppercase letter, one lowercase letter, one number, and one special character.");
      return false;
    }

    if (newPassword !== confirmPassword) {
      alert("Passwords do not match.");
      return false;
    }

    return true;
  }
</script>
<form id="form1" name="form1" method="post" action="/myapp/fs_change_pswd_post/" onsubmit="return validateForm()">
    {% csrf_token %}
  <table class="table table-bordered">
    <tr>
      <th>Old Password</th>
      <td class="password-toggle">
         <input type="text" name="textfield" class="form-control" id="textfield" required  autocomplete="off"/>
      </td>
    </tr>
    <tr>
      <th>New Password</th>
      <td class="password-toggle">
        <input type="password" name="textfield2" class="form-control" id="textfield2" required autocomplete="off" pattern="(?=.*[A-Z])(?=.*[!@#$%^&*()_+}{'\:;?/>.<,])(?=.*[0-9]).{8,})"/>
        <i class="toggle-password fas fa-eye-slash" id="togglePassword2" onclick="togglePasswordVisibility('textfield2', 'togglePassword2')"  ></i>
      </td>
    </tr>
    <tr>
      <th>Confirm Password</th>
      <td class="password-toggle">
        <input type="password" name="textfield3" class="form-control" id="textfield3" required autocomplete="off" pattern="(?=.*[A-Z])(?=.*[!@#$%^&*()_+}{'\:;?/>.<,])(?=.*[0-9]).{8,})"/>
        <i class="toggle-password fas fa-eye" id="togglePassword3" onclick="togglePasswordVisibility('textfield3', 'togglePassword3')" ></i>
      </td>
    </tr>
    <tr align="center">
      <td colspan="2">
      <input type="submit" name="button" id="button" class="btn btn-info"  value="Submit" /></td>

    </tr>
  </table>
</form>
{#<body>#}
{#   <form action="/Evapp/change_pswd_post_ev/"method="post">#}
{#       {% csrf_token %}#}
{#       <table class="table table-bordered">#}
{##}
{#           <input type="hidden"name="id1"value="{{ data.id }}">#}
{#           <tr><th>Current password</th>#}
{#           <td><input type="password"name="currentpswd"id="cpswd"class="form-control"required></td></tr>#}
{##}
{#       <tr>#}
{#           <th>New password</th>#}
{#           <td><input type="password"name="frstpwd"id="pass1" class="form-control"required></td>#}
{#       </tr>#}
{##}
{#       <tr>#}
{#           <th>Confirm Password</th>#}
{#           <td><input type="password"id="pass2"class="form-control"required></td>#}
{#       </tr>#}
{#       <tr>#}
{#           <td colspan="2"align="center"><input type="submit"value="change Password"id="change"class=" btn btn-success"></td>#}
{#       </tr>#}
{#           <tr>#}
{#               <td colspan="2" style="color: red"><p id="hint"></p></td>#}
{#           </tr>#}
{#           </table>#}
{#   </form>#}
{#</body>#}
{#<script src="/static/jquery/jquery.js" type= "application/javascript">#}
{#</script>#}
{#<script>#}
{#   $(document).ready(function () {#}
{#       $("#change").hide();#}
{#       $("#pass2").keyup(function () {#}
{#           var a=$("#pass1").val()#}
{#           var b=$("#pass2").val()#}
{#           if (a !=b){#}
{#                       document.getElementById('hint').innerHTML = "not same!!retype";#}
{#           }#}
{#           else {#}
{#               $("#change").show();#}
{##}
{#                  document.getElementById('hint').innerHTML = "ok";#}
{#           }#}
{#       })#}
{##}
{#   })#}
{% endblock %}
